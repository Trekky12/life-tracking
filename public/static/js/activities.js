"use strict";const activitiesList=document.querySelector("#activities"),loadingIconActivities=document.querySelector("#loadingIconActivities"),loadMoreActivities=document.querySelector("#loadMoreActivities");let activityDateDiv,activityWrapper;function getActivities(){if(null!==activitiesList){let t=activitiesList.querySelectorAll(".activity").length,e=20;loadingIconActivities.classList.remove("hidden"),loadMoreActivities.classList.add("hidden");let i={count:e,start:t};return getCSRFToken().then((function(t){return i.csrf_name=t.csrf_name,i.csrf_value=t.csrf_value,fetch(jsObject.activities_get,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})})).then((function(t){return t.json()})).then((function(i){if("error"!==i.status){loadingIconActivities.classList.add("hidden");let n=parseInt(i.count);t+e<n&&loadMoreActivities.classList.remove("hidden");let c=[];activitiesList.querySelectorAll(".activity-date").forEach((function(t,e){let i=t.dataset.date;c.includes(i)||c.push(i)})),i.data.forEach((function(t,e){if(!c.includes(t.date)){activityDateDiv=document.createElement("div"),activityDateDiv.classList="inner-content activity-date-wrapper",activitiesList.appendChild(activityDateDiv);let e=document.createElement("div");e.classList="inner-content-header light",activityDateDiv.appendChild(e);let i=document.createElement("h2");i.classList="activity-date",i.dataset.date=t.date,i.innerHTML=t.date,e.appendChild(i),c.push(t.date),activityWrapper=document.createElement("div"),activityWrapper.classList="page-content",activityDateDiv.appendChild(activityWrapper)}let i=document.createElement("div");i.classList="activity";let n=document.createElement("span");n.innerHTML=t.icon,i.appendChild(n);let a=document.createElement("div");a.classList.add("content");let d=document.createElement("div");d.classList="time",d.innerHTML=t.time,a.appendChild(d);let o=document.createElement("p");if(t.link){let e=document.createElement("a");e.href=t.link,e.innerHTML=t.description,o.appendChild(e)}else o.innerHTML=t.description;if(t.additional_information){let e=document.createElement("div");e.classList="additional",e.innerHTML=t.additional_information,o.appendChild(e)}a.appendChild(o),i.appendChild(a),activityWrapper.appendChild(i)}))}})).catch((function(t){console.log(t)}))}return emptyPromise()}function loadMoreActivitiesFunctions(){null!==loadMoreActivities&&(loadMoreActivities.addEventListener("click",(function(t){getActivities()})),document.addEventListener("scroll",(function(){let t=document.body,e=document.documentElement;(e.scrollTop>0&&e.scrollTop+e.clientHeight+100>=e.scrollHeight||t.scrollTop>0&&t.scrollTop+t.clientHeight+100>=t.scrollHeight)&&(loadMoreActivities.classList.contains("hidden")||getActivities())})))}document.addEventListener("DOMContentLoaded",(function(){loadMoreActivitiesFunctions(),getActivities()}));