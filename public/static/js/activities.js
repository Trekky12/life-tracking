"use strict";const activitiesList=document.querySelector("#activities"),loadingIconActivities=document.querySelector("#loadingIconActivities"),loadMoreActivities=document.querySelector("#loadMoreActivities");function getActivities(){if(null!==activitiesList){let t=activitiesList.querySelectorAll(".activity").length,e=20;loadingIconActivities.classList.remove("hidden"),loadMoreActivities.classList.add("hidden");let i={count:e,start:t};return getCSRFToken().then((function(t){return i.csrf_name=t.csrf_name,i.csrf_value=t.csrf_value,fetch(jsObject.activities_get,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})})).then((function(t){return t.json()})).then((function(i){if("error"!==i.status){loadingIconActivities.classList.add("hidden");let n=parseInt(i.count);t+e<n&&loadMoreActivities.classList.remove("hidden");let c=[];activitiesList.querySelectorAll(".activity-date").forEach((function(t,e){let i=t.dataset.date;c.includes(i)||c.push(i)})),i.data.forEach((function(t,e){if(!c.includes(t.date)){let e=document.createElement("h2");e.classList="activity-date",e.dataset.date=t.date,e.innerHTML=t.date,activitiesList.appendChild(e),c.push(t.date)}let i=document.createElement("div");i.classList="activity";let n=document.createElement("span");n.innerHTML=t.icon,i.appendChild(n);let s=document.createElement("div");s.classList.add("content");let o=document.createElement("div");o.classList="time",o.innerHTML=t.time,s.appendChild(o);let l=document.createElement("p");if(t.link){let e=document.createElement("a");e.href=t.link,e.innerHTML=t.description,l.appendChild(e)}else l.innerHTML=t.description;s.appendChild(l),i.appendChild(s),activitiesList.appendChild(i)}))}})).catch((function(t){console.log(t)}))}return emptyPromise()}function loadMoreActivitiesFunctions(){null!==loadMoreActivities&&(loadMoreActivities.addEventListener("click",(function(t){getActivities()})),document.addEventListener("scroll",(function(){let t=document.body,e=document.documentElement;(e.scrollTop>0&&e.scrollTop+e.clientHeight+100>=e.scrollHeight||t.scrollTop>0&&t.scrollTop+t.clientHeight+100>=t.scrollHeight)&&(loadMoreActivities.classList.contains("hidden")||getActivities())})))}document.addEventListener("DOMContentLoaded",(function(){loadMoreActivitiesFunctions(),getActivities()}));