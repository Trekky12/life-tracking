"use strict";const budgetSelect=document.querySelectorAll(".budget-entry select.category");budgetSelect.forEach((function(e,t){get_recurring_costs(e),add_selectr(e)}));const budget_dummy=document.querySelector("#budgetTemplate .budget-entry-dummy");function add_selectr(e){new Selectr(e,{searchable:!1,placeholder:lang.categories})}function get_recurring_costs(e){var t=e.closest(".budget-entry").querySelector(".category_costs");t.innerHTML='<i class="fas fa-circle-notch fa-spin fa-fw"></i>';for(var r=e.selectedOptions,n=[],c=0;c<r.length;c++)n.push(r[c].value);fetch(jsObject.get_category_costs+"?category[]="+n.join("&category[]="),{method:"GET",credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){var r="";r=e.value>0?e.value+" "+i18n.currency:"-",t.innerHTML=r})).catch((function(e){console.log(e)}))}document.getElementById("add_budget").addEventListener("click",(function(e){e.preventDefault();var t=document.querySelectorAll(".budget-entry").length;let r=budget_dummy.cloneNode(!0);r.classList.remove("hidden"),r.classList.remove("budget-entry-dummy"),r.classList.add("budget-entry"),r.dataset.idx=t,r.querySelectorAll("input, textarea, select").forEach((function(e,r){e.setAttribute("name",e.name.replace("DUMMY",t)),e.removeAttribute("disabled"),e.setAttribute("id",e.id.replace("DUMMY",t))})),r.querySelectorAll("label").forEach((function(e,r){e.setAttribute("for",e.getAttribute("for").replace("DUMMY",t))}));let n=document.querySelector("#budgetForm"),c=n.querySelector(".budget-entry.remaining");n.insertBefore(r,c),add_selectr("#category_"+t)})),document.addEventListener("change",(function(e){let t=e.target.closest("select.category");if(t){get_recurring_costs(t);let e=t.closest(".budget-entry").querySelector("input.description");0===e.value.length&&(e.value=t.options[t.selectedIndex].text)}})),["change","keyup"].forEach((function(e){document.addEventListener(e,(function(e){if(e.target.closest("input.value")){let e=document.getElementById("remaining_budget");var t=parseFloat(e.dataset.income),r=0;document.querySelectorAll("input.value").forEach((function(e,t){e.value&&(r+=parseFloat(e.value))})),e.innerHTML=t-r}}))}));