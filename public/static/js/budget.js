"use strict";const budgetSelect=document.querySelectorAll(".budget-entry select.category");budgetSelect.forEach((function(e,t){get_recurring_costs(e),add_selectr(e)}));const budget_dummy=document.querySelector("#budgetTemplate .budget-entry-dummy");function add_selectr(e){new Selectr(e,{searchable:!1,placeholder:lang.categories,messages:{noResults:lang.nothing_found,noOptions:lang.no_options}})}function get_recurring_costs(e){var t=e.closest(".budget-entry").querySelector(".category_costs");t.innerHTML=document.getElementById("loading-overlay").innerHTML;for(var n=e.selectedOptions,r=[],c=0;c<n.length;c++)r.push(n[c].value);fetch(jsObject.get_category_costs+"?category[]="+r.join("&category[]="),{method:"GET",credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){var n="";n=e.value>0?e.value+" "+i18n.currency:"-",t.innerHTML=n})).catch((function(e){console.log(e)}))}document.getElementById("add_budget").addEventListener("click",(function(e){e.preventDefault();var t=document.querySelectorAll(".budget-entry").length;let n=budget_dummy.cloneNode(!0);n.classList.remove("hidden"),n.classList.remove("budget-entry-dummy"),n.classList.add("budget-entry"),n.dataset.idx=t,n.querySelectorAll("input, textarea, select").forEach((function(e,n){e.setAttribute("name",e.name.replace("DUMMY",t)),e.removeAttribute("disabled"),e.setAttribute("id",e.id.replace("DUMMY",t))})),n.querySelectorAll("label").forEach((function(e,n){e.setAttribute("for",e.getAttribute("for").replace("DUMMY",t))}));let r=document.querySelector("#budgetForm"),c=r.querySelector(".budget-entry.remaining");r.insertBefore(n,c),add_selectr("#category_"+t)})),document.addEventListener("change",(function(e){let t=e.target.closest("select.category");if(t){get_recurring_costs(t);let e=t.closest(".budget-entry").querySelector("input.description");0===e.value.length&&(e.value=t.options[t.selectedIndex].text)}})),["change","keyup"].forEach((function(e){document.addEventListener(e,(function(e){if(e.target.closest("input.value")){let e=document.getElementById("remaining_budget");var t=parseFloat(e.dataset.income),n=0;document.querySelectorAll("input.value").forEach((function(e,t){e.value&&(n+=parseFloat(e.value))})),e.innerHTML=t-n}}))}));