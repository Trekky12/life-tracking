"use strict";new Sortable(document.querySelector(".grid"),{group:{name:"widget"},draggable:".card",handle:"h3",dataIdAttr:"data-widget",onUpdate:function(e){var t={widgets:this.toArray()};getCSRFToken().then((function(e){return t.csrf_name=e.csrf_name,t.csrf_value=e.csrf_value,fetch(jsObject.frontpage_widget_position,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})})).then((function(e){return e.json()})).then((function(e){})).catch((function(e){console.log(e)}))}});const widgetModal=document.getElementById("widget-modal"),modalCloseBtn=document.getElementById("modal-close-btn");modalCloseBtn.addEventListener("click",(function(e){widgetModal.style.display="none"}));const addWidgetBtn=document.getElementById("add-widget"),addWidgetBtnModal=document.getElementById("add-widget-modal");function saveWidget(e,t={}){return document.getElementById("loading-overlay").classList.remove("hidden"),getCSRFToken().then((function(n){let o={name:e,options:t,csrf_name:n.csrf_name,csrf_value:n.csrf_value};return fetch(jsObject.frontpage_widget_option_save,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})})).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)}))}widgetModal.querySelector("form").addEventListener("submit",(function(e){e.preventDefault(),document.getElementById("loading-overlay").classList.remove("hidden");let t=addWidgetBtn.parentElement.querySelector("select").value,n={};new FormData(widgetModal.querySelector("form")).forEach((function(e,t){n[t]=e})),saveWidget(t,n).then((function(){allowedReload=!0,window.location.reload()}))})),addWidgetBtn.addEventListener("click",(function(e){e.preventDefault(),document.getElementById("loading-overlay").classList.remove("hidden");let t=addWidgetBtn.parentElement.querySelector("select").value,n=widgetModal.querySelector(".modal-content");n.innerHTML="",fetch(jsObject.frontpage_widget_option+"?widget="+t,{method:"GET",credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){if("error"!==e.status){if(!e.entry)return saveWidget(t);e.entry.forEach((function(e){let t=document.createElement("div");t.classList.add("form-group");let o=document.createElement("label");if(o.innerHTML=e.label,t.appendChild(o),"select"==e.type){let n=document.createElement("select");n.classList.add("form-control"),n.name=e.name,Object.keys(e.data).forEach((function(t){let o=document.createElement("option");o.value=t,o.innerHTML=e.data[t].name,n.appendChild(o)})),t.appendChild(n)}else if("input"==e.type){let n=document.createElement("input");n.classList.add("form-control"),n.name=e.name,n.value=e.data,t.appendChild(n)}n.appendChild(t)})),widgetModal.style.display="block"}})).then((function(e){void 0!==e?(allowedReload=!0,window.location.reload()):document.getElementById("loading-overlay").classList.add("hidden")})).catch((function(e){console.log(e)}))}));