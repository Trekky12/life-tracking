!function(e){e(document).ready(function(){function t(t){var a;try{var r=e(t).datepicker("option","dateFormat");a=e.datepicker.parseDate(r,t.value)}catch(e){a=null}return a}moment.locale(i18n.template),e.datepicker.setDefaults(e.datepicker.regional[i18n.template]),e("#go-back-btn").on("click",function(e){window.history.back()}),e("#cancel").on("click",function(e){e.preventDefault(),window.history.back()}),e("body").on("click",".btn-delete",function(t){if(t.preventDefault(),e(this).data("url")){!function(e){if(!confirm(lang.really_delete))return!1;fetch(e,{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"csrf_name="+jsObject.csrf_name+"&csrf_value="+jsObject.csrf_value}).then(function(e){allowedReload=!0,window.location.reload()}).catch(function(e){alert(e)})}(e(this).data("url"))}}),e("#dateSelect").datepicker({changeMonth:!0,altFormat:"yy-mm-dd",altField:"#inputDate"}),e("#inputDate").val()&&e("#dateSelect").datepicker("setDate",moment(e("#inputDate").val()).toDate()),e("#dateSelect").change(function(){e(this).val()||e("#inputDate").val("")});var a=e("#dateStart").datepicker({changeMonth:!0,altFormat:"yy-mm-dd",altField:"#inputStart"}).on("change",function(){r.datepicker("option","minDate",t(this))});e("#inputStart").val()&&e("#dateStart").datepicker("setDate",moment(e("#inputStart").val()).toDate());var r=e("#dateEnd").datepicker({changeMonth:!0,altFormat:"yy-mm-dd",altField:"#inputEnd"}).on("change",function(){a.datepicker("option","maxDate",t(this))});if(e("#inputEnd").val()&&e("#dateEnd").datepicker("setDate",moment(e("#inputEnd").val()).toDate()),r.datepicker("option","minDate",t(a[0])),a.datepicker("option","maxDate",t(r[0])),e("span.closebtn").on("click",function(){e(this).parent().hide()}),e("#financeSummaryChart").length)new Chart(e("#financeSummaryChart"),{data:{labels:e("#financeSummaryChart").data("labels"),datasets:[{label:e("#financeSummaryChart").data("label1"),data:e("#financeSummaryChart").data("values1"),backgroundColor:"#FF0000"},{label:e("#financeSummaryChart").data("label2"),data:e("#financeSummaryChart").data("values2"),backgroundColor:"#008800"}]},type:"bar",options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{min:0}}]}}});var n=randomColor({count:100,hue:"blue",luminosity:"bright"});if(e("#financeDetailChart").length)new Chart(e("#financeDetailChart"),{data:{labels:e("#financeDetailChart").data("labels"),datasets:[{backgroundColor:n,data:e("#financeDetailChart").data("values"),label:"test"}]},type:"pie",options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"top"},tooltips:{callbacks:{title:function(e,t){return t.labels[e[0].index]},label:function(e,t){return t.datasets[e.datasetIndex].data[e.index].toFixed(2)+" "+i18n.currency}}}}});var i=null;e("#finance_table").DataTable({language:{url:jsObject.datatable},paging:!0,info:!0,responsive:!0,autoWidth:!1,order:[[0,"desc"],[1,"desc"]],columnDefs:[{targets:[0],render:function(e,t,a){return moment(e).format(i18n.dateformatJS)},responsivePriority:-1},{targets:[6,7],orderable:!1,responsivePriority:3},{targets:[1,3],responsivePriority:2},{targets:[2],responsivePriority:1},{targets:[4],responsivePriority:-1},{targets:[5],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}],processing:!0,serverSide:!0,ajax:{url:jsObject.finances_table,dataSrc:function(e){return i=e.recordsTotal!==e.recordsFiltered?e.sum:null,e.data}},deferLoading:jsObject.datacount,drawCallback:function(t){var a=this.api(),r="";null!==i&&(r=i+" "+i18n.currency),a.column(5).responsiveHidden()?e(a.column(5).footer()).html(r):e(a.column(4).footer()).html(r)}}),e("#category_table").DataTable({paging:!0,info:!0,columnDefs:[{targets:[2,3],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#category_assignment_table").DataTable({paging:!0,info:!0,columnDefs:[{targets:[4,5],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#recurring_table").DataTable({paging:!0,info:!0,order:[[3,"desc"]],columnDefs:[{targets:[8,9],orderable:!1},{targets:[4,5],render:function(e,t,a){return e?moment(e).format(i18n.dateformatJS):""}},{targets:[7],render:function(e,t,a){return e?moment(e).format(i18n.dateformatJSFull):""}},{targets:[3],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#users_table").DataTable({paging:!1,info:!1,columnDefs:[{targets:[5,6,7],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#fuel_table").DataTable({order:[[0,"desc"]],columnDefs:[{targets:[9,10],orderable:!1},{targets:[0],render:function(e,t,a){return moment(e).format(i18n.dateformatJS)}}],dom:'<"top"f>rt<"bottom"ip>',language:{url:jsObject.datatable},paging:!0,info:!0,responsive:!0,autoWidth:!1,processing:!0,serverSide:!0,ajax:jsObject.fuel_table,deferLoading:jsObject.datacount}),e("#service_table").DataTable({order:[[0,"desc"]],columnDefs:[{targets:[8,9],orderable:!1},{targets:[0],render:function(e,t,a){return moment(e).format(i18n.dateformatJS)}}],dom:'<"top"f>rt<"bottom"ip>',language:{url:jsObject.datatable},paging:!0,info:!0,responsive:!0,autoWidth:!1,processing:!0,serverSide:!0,ajax:jsObject.service_table,deferLoading:jsObject.datacount2}),e(".mileage_year_table").DataTable({order:[[0,"asc"]],dom:'<"top">rt<"bottom"ip>',language:{url:jsObject.datatable},paging:!0,info:!0,responsive:!0,autoWidth:!1}),e("#stats_table").DataTable({language:{url:jsObject.datatable},paging:!0,order:[[0,"desc"]],columnDefs:[{targets:[0],render:function(e,t,a){return e},responsivePriority:-1},{targets:[1,2,3],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e}},{targets:[4],orderable:!1}],responsive:!0,autoWidth:!1}),e("#stats_year_table").DataTable({language:{url:jsObject.datatable},paging:!0,order:[[0,"desc"]],columnDefs:[{targets:[0],render:function(e,t,a){return"display"===t||"filter"===t?moment().month(e-1).format("MMMM"):e},responsivePriority:-1},{targets:[1,2,3],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}],responsive:!0,autoWidth:!1}),e("#stats_month_table").DataTable({language:{url:jsObject.datatable},paging:!0,order:[[2,"desc"],[0,"asc"]],responsive:!0,autoWidth:!1,columnDefs:[{targets:[3],orderable:!1},{targets:[0],responsivePriority:-1},{targets:[2],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}]}),e("#stats_cat_table").DataTable({language:{url:jsObject.datatable},paging:!0,order:[[1,"desc"],[0,"asc"]],responsive:!0,autoWidth:!1,columnDefs:[{targets:[2,3],orderable:!1},{targets:[0],responsivePriority:-1},{targets:[1],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}]}),e("#cars_table").DataTable({paging:!0,info:!0,columnDefs:[{targets:[1,2],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#boards_table").DataTable({paging:!0,info:!0,columnDefs:[{targets:[1,2],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#stats_budget_table").DataTable({language:{url:jsObject.datatable},paging:!0,order:[[2,"desc"],[1,"asc"],[0,"asc"]],responsive:!0,autoWidth:!1,columnDefs:[{targets:[3,4],orderable:!1},{targets:[0],responsivePriority:-1},{targets:[2],render:function(e,t,a){return"display"===t||"filter"===t?e+" "+i18n.currency:e},responsivePriority:-1}]}),e("#notifications_table").DataTable({paging:!0,info:!0,columnDefs:[{targets:[5,6],orderable:!1}],language:{url:jsObject.datatable},responsive:!0,autoWidth:!1}),e("#checkboxCommon").length&&e("#checkboxCommon").on("change",function(){e("#commonValue").toggle();var t=e("#inputValue").val();t&&(e(this).is(":checked")?(e("#inputCommonValue").val(t),e("#inputValue").val(t/2)):(e("#inputValue").val(e("#inputCommonValue").val()),e("#inputCommonValue").val(null)))}),e(".set_calculation_date").on("click",function(t){e.ajax({url:jsObject.set_mileage_type,method:"POST",data:{state:1===e(this).data("type")&&e(this).is(":checked")?1:0},success:function(e){window.location.reload()},error:function(e){alert(e)}})}),e("input.carServiceType").change(function(){e("#carServiceFuel").toggleClass("hidden"),e("#carServiceService").toggleClass("hidden")}),e(".slider").slider({create:function(t,a){e(this).slider("option","min",e(this).data("min")),e(this).slider("option","max",e(this).data("max")),e(this).slider("value",e(this).data("level"))},slide:function(t,a){e(this).siblings(".slider-value").val(a.value)}}),e("#logviewer").length&&(e("#logviewer").scrollTop(e("#logviewer")[0].scrollHeight),e('.log-filter input[type="checkbox"]').on("change",function(t){var a=e(this).data("type");e("#logviewer .log-entry."+a).toggle(),e("#logviewer").scrollTop(e("#logviewer")[0].scrollHeight)})),e("#financesRecurringForm #dateStart").on("change",function(){e("#financesRecurringForm input[name=last_run]").val("")})})}(jQuery);