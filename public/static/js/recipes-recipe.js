"use strict";const stepsIngredientsSelect=document.querySelectorAll(".ingredient-select");stepsIngredientsSelect.forEach((function(e,o){e.addEventListener("click",(function(o){let t=e.dataset.id;document.querySelectorAll('.ingredient-select[data-id="'+t+'"]').forEach((function(o){o.classList.toggle("active"),o.checked=e.checked}))}))}));const recipesList=document.querySelector("#recipes_list"),loadingIconRecipes=document.querySelector("#loadingIconRecipes"),loadMoreRecipes=document.querySelector("#loadMoreRecipes"),filterSearchRecipes=document.getElementById("filterSearchRecipes");function getRecipes(e=!1){if(null!==recipesList){let o=e?0:recipesList.querySelectorAll(".recipe").length,t=20,c=filterSearchRecipes?filterSearchRecipes.value:"",n="list";loadingIconRecipes.classList.remove("hidden"),loadMoreRecipes.classList.add("hidden");let i=jsObject.recipes_get+"?type="+n+"&count="+t+"&start="+o+"&query="+c;return void 0!==recipesList.dataset.cookbook&&(i=i+"&cookbook="+recipesList.dataset.cookbook),fetch(i,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(c){if(e&&(recipesList.innerHTML=""),"error"!==c.status){loadingIconRecipes.classList.add("hidden");let e=parseInt(c.count);if(e>0)o+t<e?loadMoreRecipes.classList.remove("hidden"):loadMoreRecipes.classList.add("hidden"),recipesList.insertAdjacentHTML("beforeend",c.data);else{let e=document.createElement("p");e.innerHTML=lang.nothing_found,recipesList.innerHTML="",recipesList.appendChild(e),loadMoreRecipes.classList.add("hidden")}}})).catch((function(e){console.log(e)}))}return emptyPromise()}function loadMoreRecipesFunctions(){if(null!==loadMoreRecipes){loadMoreRecipes.addEventListener("click",(function(e){getRecipes()}));let e=100;document.addEventListener("scroll",(function(){let o=document.body,t=document.documentElement;(t.scrollTop>0&&t.scrollTop+t.clientHeight+e>=t.scrollHeight||o.scrollTop>0&&o.scrollTop+o.clientHeight+e>=o.scrollHeight)&&(loadMoreRecipes.classList.contains("hidden")||getRecipes())}))}}document.addEventListener("DOMContentLoaded",(function(){loadMoreRecipesFunctions(),getRecipes()})),filterSearchRecipes&&filterSearchRecipes.addEventListener("keyup",(function(e){e.preventDefault(),getRecipes(!0)}));let cookmodeWakeLock=null;const cookmodeButton=document.getElementById("cookmodeButton");async function enableCookmode(){try{cookmodeWakeLock=await navigator.wakeLock.request("screen"),cookmodeButton.textContent="üïì "+lang.recipes_cookmode_enabled,document.addEventListener("visibilitychange",(async function(){null!==cookmodeWakeLock&&"visible"===document.visibilityState&&(cookmodeWakeLock=await navigator.wakeLock.request("screen"))}))}catch(e){console.error("Error retrieving wakelock:",e.name,e.message),showToast(lang.recipes_cookmode_error,"red")}}function disableCookmode(){cookmodeWakeLock&&(cookmodeWakeLock.release(),cookmodeWakeLock=null,cookmodeButton.textContent="üç≥ "+lang.recipes_cookmode_enable)}cookmodeButton.addEventListener("click",(function(){cookmodeWakeLock?disableCookmode():enableCookmode()}));