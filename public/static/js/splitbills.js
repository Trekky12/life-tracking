"use strict";const splitbillsForm=document.getElementById("splitbillsBillsForm"),splittbillsButtons=document.querySelectorAll(".splitbill_btn"),calcButton=document.getElementById("calculateExchangeRate");if(splitbillsForm){let t=splitbillsForm.querySelectorAll("input.balance_paid"),e=splitbillsForm.querySelectorAll("input.balance_spend"),l=splitbillsForm.querySelector("#inputValue"),n=splitbillsForm.querySelector("#remaining_paid"),i=splitbillsForm.querySelector("#remaining_spend"),o=splitbillsForm.querySelectorAll("input.balance_paid_foreign"),a=splitbillsForm.querySelectorAll("input.balance_spend_foreign"),u=splitbillsForm.querySelector("#inputValueForeign"),s=splitbillsForm.querySelector("#inputRate"),r=splitbillsForm.querySelector("#inputFee");function c(t){let e=0;return t.forEach((function(t){let l=Number.parseFloat(t.value);l&&(e+=l)})),e.toFixed(2)}function d(){return""==l.value?0:parseFloat(l.value).toFixed(2)}function f(t,e){let l=c(t),n=d();e.innerHTML=(n-l).toFixed(2)}function p(){let t=u.value/s.value;return t+=t*(parseFloat(r.value)/100),t.toFixed(2)}function v(){return parseFloat(u.value)/parseFloat(l.value)}function b(){l.value=p(),o.forEach((function(t,e){t.value=0})),a.forEach((function(t,e){t.value=0})),t.forEach((function(t,e){t.value=0})),e.forEach((function(t,e){t.value=0})),f(t,n),f(e,i)}l.addEventListener("input",(function(l){t.forEach((function(t){t.value=0})),e.forEach((function(t){t.value=0})),f(t,n),f(e,i),splittbillsButtons.forEach((function(t){t.classList.add("button-outlined")}))})),splittbillsButtons.forEach((function(s,r){s.addEventListener("click",(function(r){r.preventDefault();let c=s.dataset.category,d=s.dataset.type,p=s.dataset.id,b=parseFloat(l.value),E=u?parseFloat(u.value):b;if(b>0){let l=s.parentNode.nextElementSibling;if(l.classList.add("hidden"),splittbillsButtons.forEach((function(t){t.dataset.category==c&&t.classList.add("button-outlined")})),s.classList.remove("button-outlined"),"paid"==c&&(splitbillsForm.querySelector('input[name="paid_by"]').value="person"==d?p:d),"spend"==c&&(splitbillsForm.querySelector('input[name="spend_by"]').value="person"==d?p:d),"same"==d)"paid"==c?(equal_splitting(t,b),t.forEach((function(t,e){o[e]&&(o[e].value=(t.value*v()).toFixed(2))}))):"spend"==c&&(equal_splitting(e,b),e.forEach((function(t,e){a[e]&&(a[e].value=(t.value*v()).toFixed(2))})));else if("person"==d){if("paid"==c){t.forEach((function(t){t.value=0})),splitbillsForm.querySelector('input[name="balance['+p+'][paid]"]').value=b,o.forEach((function(t){t.value=0}));let e=splitbillsForm.querySelector('input[name="balance['+p+'][paid_foreign]"]');e&&(e.value=E)}else if("spend"==c){e.forEach((function(t){t.value=0})),splitbillsForm.querySelector('input[name="balance['+p+'][spend]"]').value=b,a.forEach((function(t){t.value=0}));let t=splitbillsForm.querySelector('input[name="balance['+p+'][spend_foreign]"]');t&&(t.value=E)}}else"individual"==d&&l.classList.remove("hidden");f(t,n),f(e,i)}}))})),splitbillsForm.addEventListener("submit",(function(l){let n=c(t),i=c(e),o=d();o===n&&o===i||(l.preventDefault(),console.log(o),console.log(n),console.log(i),document.getElementById("loading-overlay").classList.add("hidden"),alert(lang.splitbills_numbers_wrong))})),t.forEach((function(e,l){e.addEventListener("input",(function(e){f(t,n)}))})),e.forEach((function(t,l){t.addEventListener("input",(function(t){f(e,i)}))})),s&&s.addEventListener("input",(function(l){b(),t.forEach((function(t){t.value=0})),e.forEach((function(t){t.value=0})),splittbillsButtons.forEach((function(t){t.classList.add("button-outlined")}))})),r&&r.addEventListener("input",(function(l){b(),t.forEach((function(t){t.value=0})),e.forEach((function(t){t.value=0})),splittbillsButtons.forEach((function(t){t.classList.add("button-outlined")}))})),u&&(u.addEventListener("input",(function(o){l.value=p(),t.forEach((function(t){t.value=0})),e.forEach((function(t){t.value=0})),f(t,n),f(e,i),splittbillsButtons.forEach((function(t){t.classList.add("button-outlined")}))})),o.forEach((function(l,o){l.addEventListener("input",(function(a){t[o].value=(l.value/v()).toFixed(2),f(t,n),f(e,i)}))})),a.forEach((function(l,o){l.addEventListener("input",(function(a){e[o].value=(l.value/v()).toFixed(2),f(t,n),f(e,i)}))})))}function equal_splitting(t,e){let l=[].slice.call(t).sort((function(){return.5-Math.random()})),n=l.length;l.forEach((function(t){let l=(e/n).toFixed(2);t.value=l,n--,e-=l}))}