"use strict";const splitbillsForm=document.getElementById("splitbillsBillsForm"),buttons=document.querySelectorAll(".splitbill_btn"),calcButton=document.getElementById("calculateExchangeRate");if(splitbillsForm){let e=splitbillsForm.querySelectorAll("input.balance_paid"),t=splitbillsForm.querySelectorAll("input.balance_spend"),l=splitbillsForm.querySelector("#inputValue"),n=splitbillsForm.querySelector("#remaining_paid"),a=splitbillsForm.querySelector("#remaining_spend"),i=splitbillsForm.querySelectorAll("input.balance_paid_foreign"),u=splitbillsForm.querySelectorAll("input.balance_spend_foreign"),c=splitbillsForm.querySelector("#inputValueForeign"),o=splitbillsForm.querySelector("#inputRate"),r=splitbillsForm.querySelector("#inputFee");function getSum(e){let t=0;return e.forEach((function(e){let l=Number.parseFloat(e.value);l&&(t+=l)})),t.toFixed(2)}function getTotal(){return parseFloat(l.value).toFixed(2)}function calculateRemaining(e,t){let l=getSum(e),n=getTotal();t.innerHTML=(n-l).toFixed(2)}function getValueInLocalCurrency(){let e=c.value/o.value;return e+=e*(parseFloat(r.value)/100),e.toFixed(2)}function getExchangeRateWithFee(){return parseFloat(c.value)/parseFloat(l.value)}function calculateValueInLocalCurrency(){l.value=getValueInLocalCurrency(),i.forEach((function(e,t){e.value=0})),u.forEach((function(e,t){e.value=0})),e.forEach((function(e,t){e.value=0})),t.forEach((function(e,t){e.value=0})),calculateRemaining(e,n),calculateRemaining(t,a)}l.addEventListener("change",(function(l){e.forEach((function(e){e.value=0})),t.forEach((function(e){e.value=0})),calculateRemaining(e,n),calculateRemaining(t,a)})),buttons.forEach((function(o,r){o.addEventListener("click",(function(r){r.preventDefault();let s=o.dataset.type,p=o.dataset.id,f=parseFloat(l.value),g=c?parseFloat(c.value):f;if(f>0){switch(s){case"paid_same":equal_splitting(e,f),e.forEach((function(e,t){i[t]&&(i[t].value=(e.value*getExchangeRateWithFee()).toFixed(2))}));break;case"paid_person":e.forEach((function(e){e.value=0})),splitbillsForm.querySelector('input[name="balance['+p+'][paid]"]').value=f,i.forEach((function(e){e.value=0}));let l=splitbillsForm.querySelector('input[name="balance['+p+'][paid_foreign]"]');l&&(l.value=g);break;case"spend_same":equal_splitting(t,f),t.forEach((function(e,t){u[t]&&(u[t].value=(e.value*getExchangeRateWithFee()).toFixed(2))}));break;case"spend_person":t.forEach((function(e){e.value=0})),splitbillsForm.querySelector('input[name="balance['+p+'][spend]"]').value=f,u.forEach((function(e){e.value=0}));let n=splitbillsForm.querySelector('input[name="balance['+p+'][spend_foreign]"]');n&&(n.value=g)}calculateRemaining(e,n),calculateRemaining(t,a)}}))})),splitbillsForm.addEventListener("submit",(function(l){let n=getSum(e),a=getSum(t),i=getTotal();i===n&&i===a||(l.preventDefault(),console.log(i),console.log(n),console.log(a),alert(lang.splitbills_numbers_wrong))})),e.forEach((function(t,l){t.addEventListener("input",(function(t){calculateRemaining(e,n)}))})),t.forEach((function(e,l){e.addEventListener("input",(function(e){calculateRemaining(t,a)}))})),o&&o.addEventListener("input",(function(e){calculateValueInLocalCurrency()})),r&&r.addEventListener("input",(function(e){calculateValueInLocalCurrency()})),c&&(c.addEventListener("input",(function(i){l.value=getValueInLocalCurrency(),calculateRemaining(e,n),calculateRemaining(t,a)})),i.forEach((function(l,i){l.addEventListener("input",(function(u){e[i].value=(l.value/getExchangeRateWithFee()).toFixed(2),calculateRemaining(e,n),calculateRemaining(t,a)}))})),u.forEach((function(l,i){l.addEventListener("input",(function(u){t[i].value=(l.value/getExchangeRateWithFee()).toFixed(2),calculateRemaining(e,n),calculateRemaining(t,a)}))})))}function equal_splitting(e,t){let l=[].slice.call(e).sort((function(){return.5-Math.random()})),n=l.length;l.forEach((function(e){let l=(t/n).toFixed(2);e.value=l,n--,t-=l}))}