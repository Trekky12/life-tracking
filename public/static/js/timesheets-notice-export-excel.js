"use strict";let totalValue=document.querySelector("#overviewTable th.total-value"),additionalFields=document.querySelectorAll("#overviewTable th .additional-field"),bodySum=document.querySelector("#overviewTable th.body-sum");function indexToColumn(e){let t="";for(e+=1;e>0;)e--,t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26);return t}totalValue&&bodySum&&additionalFields.forEach((function(e,t){e.addEventListener("input",(function(e){let t=0;additionalFields.forEach((e=>t+=parseInt(e.value)||0)),totalValue.textContent=t>0?parseInt(bodySum.textContent)+t:parseInt(bodySum.textContent)}))}));const wrapper=document.querySelector("#timesheetNoticeWrapper");document.querySelector("#excelExport").addEventListener("click",(function(e){e.preventDefault();let t=wrapper.dataset.name?wrapper.dataset.name:wrapper.dataset.projectname,o=parseInt(document.querySelector("#overviewTable").dataset.fields),r=[];const n=document.getElementById("reportHeadline").textContent,l=[{value:n.trim(),fontWeight:"bold",fontSize:16}],a=document.getElementById("excelHeaderTime"),u=a.dataset.from,d=a.dataset.to,i=[{value:a.textContent.trim(),fontWeight:"bold",fontSize:14}];let m=[];""!=n&&m.push(l),m.push(i),m.push([{value:""}]);const s=document.querySelector("#overviewTable thead"),c=Array.from(s.rows[0].cells).map(((e,t)=>{const o=e.textContent.trim();return r[t]=Math.max(r[t]||0,o.length),{value:o,fontWeight:"bold",bottomBorderStyle:"thin"}})),p=document.querySelector("#overviewTable tbody"),h=Array.from(p.rows).map((e=>Array.from(e.cells).map(((e,t)=>{const n=e.textContent.trim();return r[t]=Math.max(r[t]||0,n.length),{value:t===o+1?parseInt(n):n,type:t===o+1?Number:String}}))));m.push(c);let y=m.length;const f=document.querySelector("#overviewTable tfoot"),v=Array.from(f.rows).map((e=>Array.from(e.cells).map(((e,t)=>{let n=e.querySelector("input");const l=n?n.value:e.textContent.trim();r[t]=Math.max(r[t]||0,l.length);let a=l,u=String;return t===o+1&&(a=parseInt(l),u=Number,"sum-body"==e.dataset.type&&(a="SUM("+indexToColumn(t)+(y+1)+":"+indexToColumn(t)+(y+p.rows.length)+")",console.log(a),u="Formula"),"sum-foot"==e.dataset.type&&(console.log("test"),a="SUM("+indexToColumn(t)+(y+p.rows.length+1)+":"+indexToColumn(t)+(y+p.rows.length+f.rows.length-1)+")",console.log(a),u="Formula")),{value:a,type:u,fontWeight:"bold",topBorderStyle:"thin"}}))));m.push(...h),m.push(...v),writeXlsxFile(m,{fileName:t+"_"+u+"-"+d+"_Export.xlsx",sheet:"Sheet1",columns:r.map((e=>({width:e+2})))})}));