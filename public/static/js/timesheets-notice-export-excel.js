"use strict";const wrapper=document.querySelector("#timesheetNoticeWrapper");document.querySelector("#excelExport").addEventListener("click",(function(e){e.preventDefault();let t=wrapper.dataset.name?wrapper.dataset.name:wrapper.dataset.projectname,r=parseInt(document.querySelector("#overviewTable").dataset.fields),o=[];const a=document.getElementById("reportHeadline").textContent,n=[{value:a.trim(),fontWeight:"bold",fontSize:16}],l=document.getElementById("excelHeaderTime"),m=l.dataset.from,s=l.dataset.to,u=[{value:l.textContent.trim(),fontWeight:"bold",fontSize:14}],i=document.querySelector("#overviewTable thead"),p=Array.from(i.rows[0].cells).map(((e,t)=>{const r=e.textContent.trim();return o[t]=Math.max(o[t]||0,r.length),{value:r,fontWeight:"bold",bottomBorderStyle:"thin"}})),c=document.querySelector("#overviewTable tbody"),d=Array.from(c.rows).map((e=>Array.from(e.cells).map(((e,t)=>{const a=e.textContent.trim();return o[t]=Math.max(o[t]||0,a.length),{value:t===r+1?parseInt(a):a,type:t===r+1?Number:String}})))),h=document.querySelector("#overviewTable tfoot"),y=Array.from(h.rows[0].cells).map(((e,t)=>{const a=e.textContent.trim();return o[t]=Math.max(o[t]||0,a.length),{value:t===r+1?parseInt(a):a,type:t===r+1?Number:String,fontWeight:"bold",topBorderStyle:"thin"}}));let f=[];""!=a&&f.push(n),f.push(u),f.push([{value:""}]),f.push(p),f.push(...d),f.push(y),writeXlsxFile(f,{fileName:t+"_"+m+"-"+s+"_Export.xlsx",sheet:"Sheet1",columns:o.map((e=>({width:e+2})))})}));