"use strict";function getMarkers(e,a){return fetch(jsObject.trip_markers_url+"?from="+e+"&to="+a,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){return e.json()}).then(function(e){drawMarkers(e)}).catch(function(e){console.log(e)})}function drawMarkers(e){layerTrains.clearLayers(),layerCars.clearLayers(),layerPlanes.clearLayers(),layerCarRentals.clearLayers(),layerHotels.clearLayers(),layerEvents.clearLayers();let a=[],r=0;for(r in e){let t=e[r];if(null===t.lat||null===t.lng)continue;let l={};if(t.isTravel){t.isPlane&&(l.icon=greenIcon);let e=L.marker([t.start_lat,t.start_lng],l),r=L.marker([t.end_lat,t.end_lng],l);a.push(e),a.push(r);let n=[[t.start_lat,t.start_lng],[t.end_lat,t.end_lng]];if(t.isTrain){let e=[];e[0]=L.polyline(n,{color:"black",weight:"5"}).bindPopup(t.popup),e[1]=L.polyline(n,{color:"black",weight:"3",dashArray:"20, 20",dashOffset:"0"}).bindPopup(t.popup),e[2]=L.polyline(n,{color:"white",weight:"3",dashArray:"20, 20",dashOffset:"20"}).bindPopup(t.popup);let a=L.layerGroup(e);layerTrains.addLayer(a)}else if(t.isPlane){e.bindPopup(t.popup);let a=L.polyline(n,{color:"black",weight:"3"}).bindPopup(t.popup);layerPlanes.addLayer(e),layerPlanes.addLayer(a)}else if(t.isCar){let e=[];e[0]=L.polyline(n,{color:"gray",weight:"5"}).bindPopup(t.popup),e[1]=L.polyline(n,{color:"white",weight:"1",dashArray:"10, 10",dashOffset:"0"}).bindPopup(t.popup),layerCars.addLayer(L.layerGroup(e))}}else{let e=l;t.isCarrental?e.icon=L.divIcon({html:'<i class="fa fa-2x fa-car"></i>',iconSize:[20,20],iconAnchor:[10,10],className:"myDivIcon"}):t.isHotel&&(e.icon=L.divIcon({html:'<i class="fa fa-2x fa-bed"></i>',iconSize:[20,20],iconAnchor:[10,10],className:"myDivIcon"}));var n=L.marker([t.start_lat,t.start_lng],e);n.bindPopup(t.popup),t.isCarrental?layerCarRentals.addLayer(n):t.isHotel?layerHotels.addLayer(n):layerEvents.addLayer(n),a.push(n)}}if(a.length>0){var t=new L.featureGroup(a);mymap.fitBounds(t.getBounds())}}function initMap(){mymap=L.map("trip-map").setView([default_location.lat,default_location.lng],default_location.zoom),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',subdomains:["a","b","c"]}).addTo(mymap),mymap.addLayer(layerPlanes),mymap.addLayer(layerTrains),mymap.addLayer(layerCars),mymap.addLayer(layerCarRentals),mymap.addLayer(layerHotels),mymap.addLayer(layerEvents),(controlLayer=L.control.layers(null,null,{collapsed:!1})).addOverlay(layerPlanes,"<span id='layerPlanes'></span>"),controlLayer.addOverlay(layerTrains,"<span id='layerTrains'></span>"),controlLayer.addOverlay(layerCars,"<span id='layerStreets'></span>"),controlLayer.addOverlay(layerCarRentals,"<span id='layerCarrental'></span>"),controlLayer.addOverlay(layerHotels,"<span id='layerHotels'></span>"),controlLayer.addOverlay(layerEvents,"<span id='layerEvents'></span>"),controlLayer.addTo(mymap),getMarkers(from,to)}let layerTrains=new L.LayerGroup,layerCars=new L.LayerGroup,layerPlanes=new L.LayerGroup,layerCarRentals=new L.LayerGroup,layerHotels=new L.LayerGroup,layerEvents=new L.LayerGroup,controlLayer=null,mymap=null;const tripDays=document.querySelectorAll(".trip_day"),changeDayLinks=document.querySelectorAll(".change_day");null!==changeDayLinks&&changeDayLinks.forEach(function(e,a){e.addEventListener("click",function(a){a.preventDefault();let r=e.dataset.date;getMarkers(r,r).then(function(){if(r){let e=document.getElementById("trip_day_"+r);tripDays.forEach(function(e){e.classList.add("hidden")}),e.classList.remove("hidden")}else tripDays.forEach(function(e){e.classList.remove("hidden")});changeDayLinks.forEach(function(e){e.querySelector("button").classList.add("gray")}),e.querySelector("button").classList.remove("gray")})})});let descriptionLinks=document.querySelectorAll(".trip_day .description_text");descriptionLinks.forEach(function(e,a){e.addEventListener("click",function(e){e.preventDefault(),e.target.parentElement.classList.toggle("active")})});var greenIcon=new L.Icon({iconUrl:"/static/assets/images/marker-icon-green.png",shadowUrl:"/static/assets/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});const from=document.getElementById("inputStart").value,to=document.getElementById("inputEnd").value;initMap();