"use strict";function generateOption(e){const t=document.createElement("option");return t.value=e.id,t.selected=!0,t}function generateChip(e){const t=document.createElement("div");return t.classList.add("chip"),t.classList.add(`chip-${e.id}`),t.innerText=e.login,t.dataset.id=e.id,t}function generateIcon(e){const t=document.createElement("span");return t.classList.add("remove"),t.innerHTML="&times;",t}const users=document.getElementById("users"),input=document.getElementById("users_query"),chips=document.getElementById("users_chips");new autoComplete({data:{src:async()=>{let e=users.dataset.module;for(var t=users.selectedOptions,s=[],n=0;n<t.length;n++)s.push(t[n].value);return fetch(jsObject.usersearch+"?query="+input.value+"&module="+e+"&users[]="+s.join("&users[]="),{method:"GET",credentials:"same-origin"}).then((function(e){return e.json()})).then((function(e){return"error"!==e.status?e.data:[]})).catch((e=>[]))},keys:["login"],cache:!1},resultsList:{class:"users-collection",id:"users-collection-list",destination:"#users_collection-wrapper",position:"beforeend",tag:"ul",noResults:!0,maxResults:10},resultItem:{highlight:!0},trigger:e=>e.length>0,threshold:1,debounce:500,placeHolder:lang.searching,selector:"#users_query",wrapper:!1}),document.querySelector("#users_query").addEventListener("selection",(function(e){const t=e.detail,s=generateChip(t.selection.value);s.appendChild(generateIcon(t.selection.value)),chips.appendChild(s),users.add(generateOption(t.selection.value)),input.value=""})),document.querySelector("#users_query").addEventListener("results",(function(e){0==e.detail.results.length?(document.querySelector(".users-collection").classList.remove("hidden"),document.querySelector("#users-collection-list").classList.add("hidden")):(document.querySelector(".users-collection").classList.add("hidden"),document.querySelector("#users-collection-list").classList.remove("hidden"))})),document.querySelector("#users_query").addEventListener("close",(function(e){document.querySelector(".users-collection").classList.add("hidden")})),chips.addEventListener("click",(function(e){if("SPAN"===e.target.tagName&&e.target.classList.contains("remove")){let t=e.target.closest(".chip"),s=t.dataset.id;Array.from(users.options).forEach((e=>{e.value===s&&(e.remove(),t.remove())}))}}));