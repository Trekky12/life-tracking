"use strict";const requestWidgets=document.querySelectorAll(".request_widget");function load(e){let a=e.dataset.id;return fetch(jsObject.frontpage_widget_request+a,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(a){switch(e.innerHTML="",a.type){case"efa":e.appendChild(createEFATable(a.result));break;case"currentweather":e.appendChild(processWeather(a.result));break;case"weatherforecast":e.appendChild(processWeatherForecast(a.result))}})).catch((function(e){console.log(e)}))}function createEFATable(e){var a=document.createElement("table");a.classList.add("small","table"),a.border="0";var t=e.departureList;for(var n in t){var r=createEFADataRow(t[n]);a.appendChild(r)}return a}function createEFADataRow(e){var a=document.createElement("tr"),t=document.createElement("td");t.className="departures__departure__line",t.innerHTML='<span class="departures__departure__line__number xsmall">'+e.servingLine.number+"</span>",a.appendChild(t);var n=document.createElement("td");n.innerHTML='<span class="departures__departure__direction small">'+e.servingLine.direction+"</span>",a.appendChild(n);var r=new Date,i=0,d=r=new Date(e.dateTime.year,e.dateTime.month-1,e.dateTime.day,e.dateTime.hour,e.dateTime.minute,0);if(e.realDateTime){var l=new Date(e.realDateTime.year,e.realDateTime.month-1,e.realDateTime.day,e.realDateTime.hour,e.realDateTime.minute,0);r=l,i=(l-d)/1e3/60}else r=d;var c=r.getHours(),s=r.getMinutes();s<10&&(s="0"+s);var m="";e.servingLine.delay>0?m=e.servingLine.delay:0!==i&&(m=i);var o=document.createElement("td");o.className="departures__departure",o.innerHTML='<span class="departures__departure__time-relative small bright">'+c+":"+s+"</span>",a.appendChild(o);var p=document.createElement("td");return p.className="departures__delay",m>0&&(p.innerHTML='<span class="departures__delay__time xsmall">+ '+m+"</span>"),a.appendChild(p),a}function processWeather(e){if(e&&e.main&&void 0!==e.main.temp){var a=roundValue(e.main.temp),t=getIcon(e.weather[0].icon),n=e.weather[0].description,r=document.createElement("div"),i=document.createElement("div");i.className="large light";var d=document.createElement("span");d.className="wi weathericon "+t,i.appendChild(d);var l=document.createElement("span");l.className="bright",l.innerHTML=" "+a+"&deg;C",i.appendChild(l),r.appendChild(i);var c=document.createElement("div");return c.className="description",c.innerHTML=n,r.appendChild(c),r}}function getIcon(e){return{"01d":"wi-day-sunny","02d":"wi-day-cloudy","03d":"wi-cloudy","04d":"wi-cloudy-windy","09d":"wi-showers","10d":"wi-rain","11d":"wi-thunderstorm","13d":"wi-snow","50d":"wi-fog","01n":"wi-night-clear","02n":"wi-night-cloudy","03n":"wi-night-cloudy","04n":"wi-night-cloudy","09n":"wi-night-showers","10n":"wi-night-rain","11n":"wi-night-thunderstorm","13n":"wi-night-snow","50n":"wi-night-alt-cloudy-windy"}[e]}function roundValue(e){return parseFloat(e).toFixed(1)}function processWeatherForecast(e){for(var a=[],t=0,n=e.list.length;t<n;t++){var r=e.list[t],i=new Date(1e3*r.dt);a.push({day:i.getDate()+"."+i.getMonth()+".",weekday:moment(i).format("ddd"),icon:getIcon(r.weather[0].icon),description:r.weather[0].description,maxTemp:roundValue(r.temp.max),minTemp:roundValue(r.temp.min),rain:roundValue(r.rain)})}var d=document.createElement("table");d.className="small";var l=document.createElement("tr");d.appendChild(l);var c=document.createElement("th");l.appendChild(c);var s=document.createElement("th");l.appendChild(s);var m=document.createElement("th");m.innerHTML="max",l.appendChild(m);var o=document.createElement("th");for(var p in o.innerHTML="min",l.appendChild(o),a){r=a[p],l=document.createElement("tr");d.appendChild(l);var u=document.createElement("td");u.className="day",u.innerHTML=r.weekday,l.appendChild(u);var h=document.createElement("td");h.className="bright weather-icon",l.appendChild(h);var w=document.createElement("span");w.className="wi weathericon "+r.icon,h.appendChild(w);var g=document.createElement("span");g.className="description",g.innerHTML=r.description,h.appendChild(g);var v=document.createElement("td");v.innerHTML=r.maxTemp+"&deg;C",v.className="align-right bright max-temp",l.appendChild(v);var T=document.createElement("td");T.innerHTML=r.minTemp+"&deg;C",T.className="align-right min-temp",l.appendChild(T)}return d}requestWidgets.forEach((function(e){load(e);var a=e.dataset.reload;a>0&&setInterval((function(){load(e)}),1e3*a)}));