"use strict";const hideSelectionBtn=document.querySelector("#hide_exercise_selection"),exercisesAvailableView=document.querySelector(".available_exercises"),exercisesSelectedView=document.querySelector(".selected_exercises"),exercisesSelected=exercisesSelectedView.querySelector(".workout-selection-content");document.addEventListener("click",(function(e){let t=e.target.closest(".exercise .plus"),s=e.target.closest(".minus"),l=e.target.closest(".exercise"),n=e.target.closest(".add_set"),a=e.target.closest(".remove_set"),c=e.target.closest("#add_workout_day"),d=e.target.closest("#add_superset"),r=exercisesSelected.querySelectorAll('[data-type="workout-element"]').length;if(s){e.preventDefault();let t=s.closest('[data-type="workout-element"]'),l=t.dataset.category;if("day"===l){let e=[];for(e.push(t),t=t.nextElementSibling;t&&"day"!==t.dataset.category;)e.push(t),t=t.nextElementSibling;e.forEach((function(e){e.remove()})),showToast(lang.workouts_workoutday_removed,"blue")}else"superset"===l?(t.remove(),showToast(lang.workouts_superset_removed,"blue")):(t.remove(),showToast(lang.workouts_exercise_removed,"blue"));loadSelectedMuscles(),updateFields(),adjustAvailableExercisesColumnHeight()}if(t){e.preventDefault();let t=l.cloneNode(!0);t.classList.add("selected"),t.classList.remove("choose"),t.querySelector(".plus").classList.add("hidden"),t.querySelector(".minus").classList.remove("hidden"),t.querySelector(".handle").classList.remove("hidden"),t.querySelector(".sets").classList.remove("hidden");let s=document.createElement("input");s.type="hidden",s.name="exercises["+r+"][exercise]",s.value=l.dataset.id,t.appendChild(s);let n=parseInt(document.querySelector("#defaultSetCount").value),a=0;for(a=0;a<n;a++)addSet(t);t.querySelectorAll("input, textarea, select").forEach((function(e,t){e.name.includes("dummy")||(e.setAttribute("name",e.name.replace(/exercises\[[^\]]*\]/,"exercises["+r+"]")),e.removeAttribute("disabled"))})),exercisesSelected.appendChild(t),showToast(lang.workouts_exercise_added,"blue"),loadSelectedMuscles(),adjustAvailableExercisesColumnHeight()}if(n&&(console.log("add set"),addSet(l)),a){console.log("remove set");let e=l.querySelectorAll(".sets .set:not(.set-dummy)");if(e.length>0){e[e.length-1].remove(),showToast(lang.workouts_set_removed,"blue")}}if(c){e.preventDefault();let t=document.createElement("div");t.classList.add("workout_day_split"),t.dataset.type="workout-element",t.dataset.category="day";let s=document.createElement("div");s.classList.add("content");let l=document.createElement("input");l.type="hidden",l.name="exercises["+r+"][type]",l.value="day";let n=document.createElement("input");n.type="text",n.name="exercises["+r+"][notice]",n.required=!0;let a=document.createElement("div");a.classList.add("icons");let c=document.createElement("span");c.classList.add("minus"),c.innerHTML=document.getElementById("iconMinus").innerHTML;let d=document.createElement("span");d.classList.add("handle"),d.innerHTML=document.getElementById("iconHandle").innerHTML,a.appendChild(c),a.appendChild(d),s.appendChild(l),s.appendChild(n),t.appendChild(s),t.appendChild(a),exercisesSelected.appendChild(t),t.scrollIntoView(),showToast(lang.workouts_workoutday_added,"blue")}if(d){e.preventDefault();let t=document.createElement("div");t.classList.add("workout_superset"),t.dataset.type="workout-element",t.dataset.category="superset";let s=document.createElement("div");s.classList.add("content");let l=document.createElement("h2");l.innerHTML=lang.workouts_superset;let n=document.createElement("input");n.type="hidden",n.name="exercises["+r+"][type]",n.value="superset";let a=document.createElement("div");a.classList.add("exercises"),a.dataset.type="superset";let c=document.createElement("div");c.classList.add("icons");let d=document.createElement("span");d.classList.add("minus"),d.innerHTML=document.getElementById("iconMinus").innerHTML;let o=document.createElement("span");o.classList.add("handle"),o.innerHTML=document.getElementById("iconHandle").innerHTML,c.appendChild(d),c.appendChild(o),s.appendChild(l),s.appendChild(n),s.appendChild(a),t.appendChild(s),t.appendChild(c),exercisesSelected.appendChild(t),t.scrollIntoView(),showToast(lang.workouts_superset_added,"blue"),createSortable(a)}}));const workoutSupersets=document.querySelectorAll(".workout_superset .exercises");function createSortable(e){new Sortable(e,{group:{name:"exercise"},scroll:!0,scrollSensitivity:100,swapThreshold:.5,fallbackOnBody:!1,forceFallback:!0,handle:".handle",dataIdAttr:"data-id",onUpdate:function(e){updateFields()},onAdd:function(e){let t=e.to.dataset.type,s=e.item.querySelector('input[name*="is_child"]');s.value="main"===t?0:1,updateFields()}})}function updateFields(){exercisesSelected.querySelectorAll('[data-type="workout-element"]').forEach((function(e,t){e.querySelectorAll("input, textarea, select").forEach((function(e){e.setAttribute("name",e.name.replace(/exercises\[[^\]]*\]/,"exercises["+t+"]"))}))}))}workoutSupersets.forEach((function(e,t){createSortable(e)})),createSortable(exercisesSelected);const usedMusclesWrapper=document.querySelector("#usedMusclesWrapper");function loadSelectedMuscles(){if(usedMusclesWrapper){let e=[];exercisesSelected.querySelectorAll(".exercise").forEach((function(t,s){e.push(t.dataset.id)}));let t={exercises:e};getCSRFToken().then((function(e){return t.csrf_name=e.csrf_name,t.csrf_value=e.csrf_value,fetch(jsObject.workouts_exercises_selected_muscles,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})})).then((function(e){return e.json()})).then((function(e){"error"!==e.status&&(usedMusclesWrapper.innerHTML=e.data)})).catch((function(e){console.log(e)}))}}function addSet(e){let t=e.querySelector(".sets .set-list"),s=e.querySelector(".sets .set-dummy"),l=e.querySelectorAll(".sets .set").length,n=s.cloneNode(!0);n.classList.remove("hidden"),n.classList.remove("set-dummy"),n.querySelector(".set-nr").innerHTML=l;let a=n.querySelectorAll("input, select");console.log(a),a.forEach((function(e,t){e.setAttribute("name",e.name.replace("dummy",l-1)),e.removeAttribute("disabled")})),t.appendChild(n),showToast(lang.workouts_set_added,"blue")}function adjustAvailableExercisesColumnHeight(){!isMobile()&&exercisesAvailableView&&(exercisesAvailableView.style.height="500px",exercisesAvailableView.style.height=exercisesSelectedView.offsetHeight-10+"px")}hideSelectionBtn&&hideSelectionBtn.addEventListener("click",(function(e){exercisesAvailableView.classList.toggle("hidden"),exercisesAvailableView.classList.contains("hidden")?(hideSelectionBtn.textContent=lang.show,exercisesSelectedView.style.gridArea=" 2 / 1 / 3 / 3"):(hideSelectionBtn.textContent=lang.hide,exercisesSelectedView.style.removeProperty("grid-area"))})),adjustAvailableExercisesColumnHeight();