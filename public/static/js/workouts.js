"use strict";const exercisesSelected=document.querySelector("#exercises_selected .content");document.addEventListener("click",(function(e){let t=e.target.closest(".exercise .plus"),s=e.target.closest(".exercise .minus"),r=e.target.closest(".exercise .headline"),c=e.target.closest(".exercise"),i=e.target.closest(".add_set"),l=e.target.closest(".remove_set");if(s&&(e.preventDefault(),c.remove()),t){e.preventDefault();let t=exercisesSelected.childElementCount,s=c.cloneNode(!0);s.classList.add("selected"),s.querySelector(".plus").classList.add("hidden"),s.querySelector(".minus").classList.remove("hidden"),s.querySelector(".handle").classList.remove("hidden"),s.querySelector(".sets").classList.remove("hidden");let r=document.createElement("input");r.type="hidden",r.name="exercises["+t+"][id]",r.value=c.dataset.id,s.appendChild(r),s.querySelectorAll(".sets input").forEach((function(e,s){e.name.includes("dummy")||(e.setAttribute("name",e.name.replace(/exercises\[[^\]]*\]/,"exercises["+t+"]")),e.removeAttribute("disabled"))})),exercisesSelected.appendChild(s)}if(r&&(e.preventDefault(),e.target.parentElement.classList.toggle("active")),i){console.log("add set");let e=c.querySelector(".sets .set-list"),t=c.querySelector(".sets .set-dummy"),s=c.querySelectorAll(".sets .set").length,r=t.cloneNode(!0);r.classList.remove("hidden"),r.classList.remove("set-dummy"),r.querySelector(".set-nr").innerHTML=s,r.querySelectorAll("input").forEach((function(e,t){e.setAttribute("name",e.name.replace("dummy",s-1)),e.removeAttribute("disabled")})),e.appendChild(r)}if(l){let e=c.querySelectorAll(".sets .set:not(.set-dummy)");if(e.length>0){e[e.length-1].remove()}}})),new Sortable(exercisesSelected,{group:{name:"exercise"},draggable:".exercise.selected",handle:".handle",dataIdAttr:"data-id",onUpdate:function(e){this.toArray();exercisesSelected.querySelectorAll(".exercise").forEach((function(e,t){e.querySelectorAll("input").forEach((function(e){e.setAttribute("name",e.name.replace(/exercises\[[^\]]*\]/,"exercises["+t+"]"))}))}))}});const exercisesAvailable=document.querySelector("#exercises_available"),exercisesList=document.querySelector("#exercises_available_list"),loadingIconExercises=document.querySelector("#loadingIconExercises"),loadMoreExercises=document.querySelector("#loadMoreExercises"),filterBodyparts=document.getElementById("filterBodyParts");function getExercises(){if(null!==exercisesList){let e=exercisesList.querySelectorAll(".exercise").length,t=10,s=filterBodyparts.value;return loadingIconExercises.classList.remove("hidden"),loadMoreExercises.classList.add("hidden"),fetch(jsObject.workouts_exercises_get+"?count="+t+"&start="+e+"&bodypart="+s,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(s){if("error"!==s.status){loadingIconExercises.classList.add("hidden");let r=parseInt(s.count);e+t<r&&loadMoreExercises.classList.remove("hidden"),exercisesList.insertAdjacentHTML("beforeend",s.data)}})).catch((function(e){console.log(e)}))}return emptyPromise()}function loadMoreExercisesFunctions(){null!==loadMoreExercises&&(loadMoreExercises.addEventListener("click",(function(e){getExercises()})),exercisesAvailable.addEventListener("scroll",(function(){exercisesAvailable.scrollTop>0&&exercisesAvailable.scrollTop+exercisesAvailable.clientHeight+100>=exercisesAvailable.scrollHeight&&(loadMoreExercises.classList.contains("hidden")||getExercises())})))}document.addEventListener("DOMContentLoaded",(function(){loadMoreExercisesFunctions(),getExercises()})),filterBodyparts.addEventListener("change",(function(e){exercisesList.innerHTML="",getExercises()}));