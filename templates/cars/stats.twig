{% extends "base.twig" %}

{% set active = 'car_service' %}


{% block javascript %}
    <script>
        $(document).ready(function () {
        var COLORS = [
                '#4dc9f6',
                '#f67019',
                '#f53794',
                '#537bc4',
                '#acc236',
                '#166a8f',
                '#00a950',
                '#58595b',
                '#8549ba'
        ];
        if ($("#fuelChart").length) {
        var fuelChart = new Chart($("#fuelChart"), {
        data: {
        labels: $("#fuelChart").data('labels'),
                datasets: [
        {% for el in data %}
                    {
                    label: lang.consumption + " {{el["name"]}}",
                            data:{{el["data"]|json_encode(constant('JSON_NUMERIC_CHECK'))|raw}},
                            fill: false,
                            borderColor: COLORS[{{loop.index}}]
                    },
        {% endfor %}
                    ]
            },
                    type: 'line',
                    options: {

                    }
            });
            }
            });
    </script>
{% endblock %}



{% block body %}
    <div class="inner-content">
        <div class="page-header"><h2>{{lang["MENU_FUEL"]}} {{lang["STATS"]}}</h2></div>
        <div class="page-content">
            <canvas id="fuelChart" data-labels="{{labels}}"></canvas>
        </div>
    </div>
    <div class="inner-content">
        <div class="page-header"><h2>{{lang["MILEAGE_PER_YEAR"]}}</h2></div>
        <div class="page-content">
            
            <div class="two-columns">
                    <div class="left">
                        <label class="radio" for="calculation_type_0">
                            <input class="set_calculation_date" name="calculation_type" data-type="0" type="radio" id="calculation_type_0" {% if mileage_calc_type is not null and mileage_calc_type == 0 %}checked="checked"{% endif %}>
                            {{lang["START_WITH_FIRST_ENTRY"]}}
                        </label>
                    </div>
                    <div class="right">
                        <label class="radio" for="calculation_type_1">
                            <input class="set_calculation_date" name="calculation_type" data-type="1" type="radio" id="calculation_type_1" {% if mileage_calc_type is not null and mileage_calc_type == 1 %}checked="checked"{% endif %}>
                            {{lang["START_WITH_YEAR"]}}
                        </label>
                    </div>
                </div>
            
            {% for car, entries in table %}

                <h2>{{cars[car].name}} ({% if totalMileages[car]["max"] > totalMileages[car]["min"] %}{{totalMileages[car]["diff"]}} {{lang["KM"]}}{% endif %})</h2>

                <table class="mileage_year_table table table-hover small">
                    <thead>
                        <tr>
                            <th>{{lang["DATE"]}}</th>
                            <th>{{lang["MILEAGE_PER_YEAR"]}}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in entries %}
                            <tr>
                                <td data-title="{{lang["DATE"]}}">{{entry.start|date(i18n.twig)}} - {{entry.end|date(i18n.twig)}}</td> 
                                <td data-title="{{lang["MILEAGE_PER_YEAR"]}}">{{entry.diff}}</td> 
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endfor %}
        </div>
    </div>
{% endblock %}