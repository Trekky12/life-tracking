{% extends "base.twig" %}

{% set active = 'profile' %}

{% block pageheader %}
	<div class="page-header">
		<div class="page-headline">
			<h2>{{"TWOFACTOR_AUTHENTICATION"|trans}}</h2>
		</div>
	</div>
{% endblock %}

{% block tabbar %}
	{% include "profile/profile-tabs.twig" with {'active':'users_twofactorauth'} only %}
{% endblock %}

{% block body %}
	<div class="inner-content">
		<div class="page-content">

			{% if not hasSecret %}
				<form action="{{ url_for('users_twofactorauth_enable') }}" method="POST">
					<input type="hidden" name="{{csrf.keys.name}}" value="{{csrf.name}}">
					<input type="hidden" name="{{csrf.keys.value}}" value="{{csrf.value}}">

					<div class="form-group">
						<p>{{ "TWOFACTOR_TEXT"|trans }}</p>
					</div>
					<div class="form-group">
						<img src="{{ qr }}"/>
						<p class="twofactor-secret">{{ secret }}</p>
					</div>

					<div class="form-group">
						<label for="inputVerificationCode">{{"TWOFACTOR_CODE"|trans}}</label>
						<input name="code" id="inputVerificationCode" class="form-control" type="number" pattern="\d*">
					</div>

					<div class="form-group">
						<button type="submit" class="button">{{"SAVE"|trans}}</button>
					</div>
				</form>

			{% else %}
				<form action="{{ url_for('users_twofactorauth_disable') }}" method="POST">
					<input type="hidden" name="{{csrf.keys.name}}" value="{{csrf.name}}">
					<input type="hidden" name="{{csrf.keys.value}}" value="{{csrf.value}}">

					<div class="form-group">
						<button type="submit" class="button button-outlined">{{"TWOFACTOR_DISABLE"|trans}}</button>
					</div>
				</form>
			{% endif %}

		</div>
	</div>

</div>{% endblock %}
