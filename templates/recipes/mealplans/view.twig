{% extends "base.twig" %}

{% set active = 'recipes' %}

{% block javascript %}
    <script src="{{baseURL}}/static/js/datefilter.js?ver=20191031"></script>
    <script src="{{baseURL}}/static/assets/js/Sortable.min.js"></script>
    <script src="{{baseURL}}/static/js/recipes_mealplan.js?ver=20210801"></script>
{% endblock %}

{% block body %}

    <div class="inner-content">
        <div class="page-header"><h2>{{lang["RECIPES_MEALPLAN"]}} | {{ mealplan.name|raw }}</h2> 
            <div class="buttons">
                <a href="{{ url_for('recipes_mealplans')}}"><button class="white">{{lang["BACK"]}} {{ fontawesome('fas fa-level-up-alt') }}</button></a>
            </div>
        </div>
        <div class="page-content">
            <form method="GET" id="search-filter" action="{{  url_for('recipes_mealplans_view', {'mealplan' : mealplan.hash}) }}">
                <div class="filter-content">
                    <div class="date-filter">
                        <div class="date-element">
                            <input type="text" id="dateRange" value="{{from}} to {{to}}" />

                            <input type="hidden" id="inputStart" name="from" value="{{from}}"/>
                            <input type="hidden" id="inputEnd" name="to" value="{{to}}"/>
                        </div>
                        <div class="filter-element">
                            <input type="submit" value="{{lang["SHOW"]}}"/>
                        </div>
                    </div>
                </div>
            </form>  
        </div>
    </div>
    <div class="mealplan-list">
        <div class="mealplans" >
            {% for date in dates %}

                <div class="inner-content recipe-list">
                    <div class="mealplan-date">
                        <h2>{{ date["date"] }}</h2>
                        <div class="recipes-target" data-date="{{ date["date"] }}">
                            {% for recipe_of_day in date["recipes"] %}
                                <div class="mealplan-recipe" data-recipe="{{ recipe_of_day["recipe_id"] }}" data-id="{{ recipe_of_day["id"] }}">
                                    <div class="title">
                                        <div class="icons">
                                            <span class="handle">{{ fontawesome('fas fa-arrows-alt') }}</span>
                                        </div>
                                        <h3><a href="{{ url_for('recipes_recipe_view', {'recipe': recipe_of_day["recipe_hash"]}) }}">{{ recipe_of_day["recipe_name"]|raw }}</a></h3>
                                    </div>
                                    <div class="icons">
                                        <span class="minus">{{ fontawesome('fas fa-minus') }}</span>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

            {% endfor %}
        </div>
        <div class="inner-content page-content mealplan-list-settings">
            <div class="recipe-filter">
                <input type="text" id="filterSearchRecipes" placeholder="{{ lang["SEARCHING"] }}"/>
            </div>
            <div class="content">
                <div id="recipes_list"></div>
                <div id="loadingIconRecipes" class="centered loading-icon">
                    <span class="spinning">{{ fontawesome('fas fa-circle-notch') }}</span>
                </div>
            </div>
        </div>
    </div>


{% endblock %}